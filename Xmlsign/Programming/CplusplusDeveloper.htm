<html>
<head>
<title>Programming SecureXML Home</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--webbot bot="PurpleText" PREVIEW="Meta Data Starts Here" -->
<meta name="title" content="Infomosaic: XML Signature">
<meta name="keywords" content="XML security, XML Signature, Digital Signature, Web Service Security, XML Signature ActiveX, XML Security Made Easy, Secure Web Application, smart card, services and products for secure e-business,">
<meta name="description" content="Infomosaic provides XML Security Software. SecureXML is the first C-Language implementation of the W3C XML Digital Signature standard. Its small 
              code size is highly optimized making it most appropriate for high 
              volume XML transaction applications">
<META NAME="abstract" CONTENT="Infomosaic provides XML Security Software. SecureXML is the first C-Language 
              implementation of the W3C XML Digital Signature standard. Its small 
              code size is highly optimized making it most appropriate for high 
              volume XML transaction applications">
<META NAME="revisit-after" CONTENT="3 days">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<!--webbot bot="PurpleText" PREVIEW="Meta Data Ends Here" -->
</head>
<body bgcolor="#FFFFFF">
<div align="left"></div>
<table border="0" align="left" height="689" cellspacing="0" width="730" cellpadding="0">
  <tr valign="top" align="left"> 
    <td colspan="2" height="177"> 
      <div align="left"><a href="../OnlineApps/index.html"> </a> 
        <table border="0" cellpadding="0" cellspacing="0" width="730">
          <!-- fwtable fwsrc="toplinks.png" fwbase="toplinks.jpg" fwstyle="Dreamweaver" fwdocid = "742308039" fwnested="1" -->
          <tr> 
            <td colspan="22"><img name="toplinks_r1_c1" src="../LocalWebApps/newimages/toplinks_r1_c1.jpg" width="730" height="133" border="0"></td>
          </tr>
        </table>
        <hr color="#FF9933">
      </div>
    </td>
  </tr>
  <tr> 
    <td width="100" height="548" valign="top" background="../OnlineApps/orangeswipe.gif"> 
      <p><a href="index.htm"><font color="#009999"><b>Programming Home</b></font></a></p>
    </td>
    <td height="548" valign="top" width=595>      <table width="90%" border="0" align="center">
        <tr> 
          <td><font face="Arial, Helvetica, sans-serif" size="3"><b><font color="#009999">Using 
            <font color="#FF9933">S</font>ecure<font color="#FF9933">X</font>ML 
            from Microsoft Visual C++ 6.0 </font></b></font> 
            <p>The C and C++ language sample applications are included in the 
            </p>
            <p><font color="#FF0000">C:\Program Files\Infomosaic\SecureXML\Programming\Programming.dsw</font> 
              Visual Studio workspace. Please open Programming.dsw workspace from 
              Visual C++ 6.0 environment and look at the SecureXMLFromCpp project. 
              The source code of <font color="#FF0000">SecureXMLFromCpp.cpp </font>from 
              this project is shown below.</p>
            <p>Before compiling any C++ programs, please make sure that XMLSign.idl 
              file is included in your project and it is part of the build process. 
              You may have to manually specify the build command for the idl file 
              if one is not added automatically by Visual Studio. You can do this 
              by specifying midl $(InputPath) for the custom build command and 
              an output directory for XMLSign.idl file by right clicking XMLSign.idl 
              in the FileView and choosing Settings.</p>
            <p>#include &quot;stdafx.h&quot;<br>
              <font color="#009900">/* The following two files are generated by 
              Visual Studio provided IDL compiler: MIDL */</font><br>
              #include &quot;XMLSign.h&quot;<br>
              #include &quot;XMLSign_i.c&quot;</p>
            <p>int main(int argc, char* argv[])<br>
              {<br>
              HRESULT hr;<br>
              IUnknown *pUnknown;<br>
              ISignature *pSig;<br>
              BSTR verifyR;<br>
              BSTR inputData;</p>
            <p> <font color="#009900">/* Initialize Windows COM Infrastructure 
              */</font><br>
              hr = CoInitialize(NULL);<br>
              if (FAILED(hr)) {<br>
              printf(&quot;%s&quot;,&quot;CoInitialize failed.\n&quot;);<br>
              exit(0);<br>
              }</p>
            <p> <font color="#009900">/* Create an instance of SecureXML Digital 
              Signature */</font><br>
              hr = CoCreateInstance(CLSID_Signature, NULL, CLSCTX_INPROC_SERVER, 
              <br>
              IID_IUnknown, (void **) &amp;pUnknown);<br>
              if (FAILED(hr)) {<br>
              printf(&quot;%s&quot;,&quot;CoCreateInstance failed.\n&quot;);<br>
              exit(0);<br>
              }</p>
            <p> <font color="#009900">/* Create a XMLSign.Signature Object and 
              obtain it's handle */</font><br>
              hr = pUnknown-&gt;QueryInterface(IID_ISignature, (void **) &amp;pSig);<br>
              if (FAILED(hr)) {<br>
              printf(&quot;%s&quot;,&quot;QueryInterface failed.\n&quot;);<br>
              exit(0);<br>
              }</p>
            <p> <font color="#009900">/* Now pSig is a pointer to a XMLSign.Signature 
              Object */<br>
              /* Since we don't want any more Signature objects, release the handle 
              to SecureXML */</font><br>
              pUnknown-&gt;Release();</p>
            <p> <font color="#009900">/* Lets invoke some methods and set a few 
              properties to make sure we can use it */</font><br>
              hr = pSig-&gt;<font color="#FF0000">ReadAll</font>(L&quot;TwoSignature.xml&quot;, 
              &amp;inputData);<br>
              printf(&quot;After ReadAll\n&quot;);<br>
              if (hr != S_OK) {<br>
              printf(&quot;%s&quot;,&quot;ReadAll failed.\n&quot;);<br>
              exit(0);<br>
              }</p>
            <p> hr = pSig-&gt;<font color="#FF0000">SecureXMLVerify</font>(inputData, 
              &amp;verifyR);<br>
              printf(&quot;After SecureXMLVerify\n&quot;);<br>
              if (hr != S_OK) {<br>
              printf(&quot;%s&quot;,&quot;SecureXMLVerify failed.\n&quot;);<br>
              exit(0);<br>
              }<br>
              printf(&quot;%ws&quot;, verifyR);<br>
              /* Release memory allocated by SecureXML */<br>
              SysFreeString(inputData);<br>
              SysFreeString(verifyR);</p>
            <p> <font color="#009900">/* Now lets create a new signature */</font><br>
              hr = pSig-&gt;<font color="#FF0000">put_SignatureID</font>(0, L&quot;MySignature&quot;);<br>
              BSTR tmpSignedXMLFileName;<br>
              hr = pSig-&gt;<font color="#FF0000">Sign</font>(L&quot;catalog.xml&quot;, 
              &amp;tmpSignedXMLFileName);<br>
              hr = pSig-&gt;<font color="#FF0000">put_OverwriteFile</font>(1);<br>
              hr = pSig-&gt;<font color="#FF0000">SaveXMLSignature</font>(L&quot;catalogSigned.xml&quot;); 
              <font color="#009900">/* catalogSigned.xml now contains the signed 
              xml */</font></p>
            <p><font color="#009900">/* Release memory allocated by SecureXML 
              */</font><br>
              SysFreeString(tmpSignedXMLFileName);<br>
              pSig-&gt;<font color="#FF0000">Release</font>();<br>
              CoUninitialize();<br>
              }<br>
            </p>
          </td>
        </tr>
      </table></td>
  </tr>
  <tr> 
    <td colspan="2" height="46" valign="top" background="../OnlineApps/orangeswipe.gif"> 
      <div align="center">All contents are Copyright © 2000--2002 Infomosaic Corporation. 
        All rights reserved. <br>
        Page last updated on 
        <!-- #BeginDate format:fcAm1 -->Thursday, January 2, 2003<!-- #EndDate -->
      </div>
    </td>
  </tr>
</table>
</body>
</html>
