<html>
<head>
<title>Programming SecureXML Home</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--webbot bot="PurpleText" PREVIEW="Meta Data Starts Here" -->
<meta name="title" content="Infomosaic: XML Signature">
<meta name="keywords" content="XML security, XML Signature, Digital Signature, Web Service Security, XML Signature ActiveX, XML Security Made Easy, Secure Web Application, smart card, services and products for secure e-business,">
<meta name="description" content="Infomosaic provides XML Security Software. SecureXML is the first C-Language implementation of the W3C XML Digital Signature standard. Its small 
              code size is highly optimized making it most appropriate for high 
              volume XML transaction applications">
<META NAME="abstract" CONTENT="Infomosaic provides XML Security Software. SecureXML is the first C-Language 
              implementation of the W3C XML Digital Signature standard. Its small 
              code size is highly optimized making it most appropriate for high 
              volume XML transaction applications">
<META NAME="revisit-after" CONTENT="3 days">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<!--webbot bot="PurpleText" PREVIEW="Meta Data Ends Here" -->
</head>
<body bgcolor="#FFFFFF">
<div align="left"></div>
<table border="0" align="left" height="689" cellspacing="0" width="730" cellpadding="0">
  <tr valign="top" align="left"> 
    <td colspan="2" height="177"> 
      <div align="left"><a href="../OnlineApps/index.html"> </a> 
        <table border="0" cellpadding="0" cellspacing="0" width="730">
          <!-- fwtable fwsrc="toplinks.png" fwbase="toplinks.jpg" fwstyle="Dreamweaver" fwdocid = "742308039" fwnested="1" -->
          <tr> 
            <td colspan="22"><img name="toplinks_r1_c1" src="../LocalWebApps/newimages/toplinks_r1_c1.jpg" width="730" height="133" border="0"></td>
          </tr>
        </table>
        <hr color="#FF9933">
      </div>
    </td>
  </tr>
  <tr> 
    <td width="100" height="548" valign="top" background="../OnlineApps/orangeswipe.gif"> 
      <p><a href="index.htm"><font color="#009999"><b>Programming Home</b></font></a></p>
    </td>
    <td height="548" valign="top" width=568> 
      <table width="90%" border="0" align="center">
        <tr> 
          <td><font size="3" face="Arial, Helvetica, sans-serif"><b><font color="#009999">Using 
            <font color="#FF9933">S</font>ecure<font color="#FF9933">X</font>ML 
            Digital Signature from JavaScript </font></b></font> 
            <p>The process of using SecureXML from JavaScript either on the client 
              side or on an ASP page on the server side starts with first creating 
              an instance of the SecureXML Signature object by doing a new ActiveXObjecton 
              on the client side and Server.CreateObject for server side usage:</p>
            <p>var SigObj;<br>
              SigObj = new ActiveXObject(&quot;XMLSign.Signature&quot;) on the 
              client side and<br>
              SigObj = Server.CreateObject(&quot;XMLSign.Signature&quot;) on an 
              ASP page for server side usage.</p>
            <p>Access to all methods and properties are straight forward as their 
              names remain exactly the same as in the XMLSign.idl file.</p>
            <p>After completion of the SignNow() function, signedXML <br>
              var signedXML=null;<br>
              var signedXMLFile=null;<br>
              var count;<br>
              var newImagePath;</p>
            <p>function SignNow()<br>
              {<br>
              var SigDate, ErrorCode;<br>
              SigDate = new Date();<br>
              // Create an instance of the SecureXML Digital Signature Object<br>
              var SigObj = new ActiveXObject(&quot;XMLSign.Signature&quot;);<br>
              // Set a few object properties<br>
              SigObj.SignatureID(0) = &quot;MySignature&quot;;<br>
              SigObj.Properties(0,0) = &quot;SignatureDate = &quot; + SigDate.toString();<br>
              // Lets capture a live signature image<br>
              SigObj.PhysicalSignatureUsage = 2;<br>
              // Select the certificate to be used for subsequent signing. <br>
              // You can skip this step if you would rather see a certificate 
              selection window<br>
              SigObj.SetActiveCertificate(SigObj.GetCertificateInfo(0, 1));<br>
              // Sign a simple data string<br>
              signedXML = SigObj.SignDataStr(&quot;This is my input&quot;)<br>
              ErrorCode = SigObj.GetLastError()<br>
              if (ErrorCode != 0) {<br>
              if (ErrorCode == 13) {<br>
              alert(&quot;No Certificate Selected&quot;);<br>
              }<br>
              else {<br>
              if (ErrorCode == 45) {<br>
              alert(&quot;You either do not have signature creation license or 
              your license has expired&quot;);<br>
              }<br>
              else {<br>
              alert(&quot;Signature Creation Failed. Last Error = &quot; + ErrorCode 
              + &quot; Error Stack = &quot; + SigObj.GetError());<br>
              }<br>
              }<br>
              return false;<br>
              }<br>
              else { // Signature was created successfully<br>
              var uriCount, docUri, uriIndex, imageURI;<br>
              // Verify the signature we just created<br>
              SigObj.VerifyXMLStr(signedXML);<br>
              signatureId = SigObj.SignatureID(0);<br>
              // The following code shows how to extract the signature image that 
              was captured during signature creation<br>
              uriCount = SigObj.TotalUriCount;<br>
              imageURI = &quot;#SignatureImage_&quot; + signatureId;<br>
              for (uriIndex = 0; uriIndex &lt; uriCount; uriIndex++) {<br>
              docUri = SigObj.DocumentURI(0,uriIndex);<br>
              if (docUri == imageURI) {<br>
              newImagePath = SigObj.SignedDocumentPath(0,uriIndex);<br>
              // newImagePath now contains the complete path for the file containing 
              the signature image<br>
              break;<br>
              }<br>
              }<br>
              }<br>
              return false;<br>
              }<br>
            </p>
          </td>
        </tr>
      </table>      </td>
  </tr>
  <tr> 
    <td colspan="2" height="46" valign="top" background="../OnlineApps/orangeswipe.gif"> 
      <div align="center">All contents are Copyright © 2000--2002 Infomosaic Corporation. 
        All rights reserved. <br>
        Page last updated on 
        <!-- #BeginDate format:fcAm1 -->Thursday, January 2, 2003<!-- #EndDate -->
      </div>
    </td>
  </tr>
</table>
</body>
</html>
